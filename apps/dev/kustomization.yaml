# apiVersion: kustomize.config.k8s.io/v1beta1
# kind: Kustomization
# namespace: chama-dev

# resources:
#   - ../base

# images:
#   - name: gitauwairimu/chama-backend
#     newName: gitauwairimu/dev-backend
#     newTag: 1.2.7-f96ec50-dev
#   - name: gitauwairimu/chama-frontend
#     newName: gitauwairimu/dev-frontend
#     newTag: 1.2.7-f96ec50-dev

# patchesStrategicMerge:
#   - backend-patch.yaml
#   - frontend-patch.yaml




















apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

namespace: chama-dev

resources:
  - ../base

images:
  - name: gitauwairimu/chama-backend
    newName: gitauwairimu/dev-backend
    newTag: 1.2.7-f96ec50-dev
  - name: gitauwairimu/chama-frontend
    newName: gitauwairimu/dev-frontend
    newTag: 1.2.7-f96ec50-dev

# REPLACE patchesStrategicMerge with patches
patches:
  - target:
      kind: Deployment
      name: backend
      namespace: chama-dev  # ← ADD NAMESPACE
    path: backend-patch.yaml
  - target:
      kind: Deployment
      name: frontend
      namespace: chama-dev  # ← ADD NAMESPACE
    path: frontend-patch.yaml
  - path: hpa-patch.yaml
    target:
      kind: HorizontalPodAutoscaler
      name: backend-hpa

labels:
  - pairs:
      environment: dev